webpackJsonp([2],{Quw4:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("gyMJ"),n=s("l+Ju"),o=s.n(n),r={name:"login",data:function(){var t=this;return{signForm:{name:"",pass:"",regcode:"",repass:""},islogin:!0,showSign:!1,regcode:"",regCodeClass:null,signRules:{name:[{validator:function(t,i,s){if(""===i)s(new Error("请输入账号"));else{if(!/^[a-zA-Z0-9_]{2,8}$/.test(i))return void s(new Error("请输入2~8位数字字母下划线"));s()}},trigger:"blur"}],pass:[{validator:function(t,i,s){if(""===i)s(new Error("请输入密码"));else{if(!/^[a-zA-Z0-9]{6,12}$/.test(i))return void s(new Error("请输入6~12位数字字母组合"));s()}},trigger:"blur"}],repass:[{validator:function(i,s,e){if(""===s)e(new Error("请输入确认密码"));else{if(s!==t.signForm.pass)return void e(new Error("两次密码输入不一致"));e()}},trigger:"blur"}],regcode:[{validator:function(i,s,e){if(""===s)e(new Error("请输入验证码"));else{if(s.toLowerCase()!==t.regcode.toLowerCase())return t.regCodeClass.drawAgain(),void e(new Error("验证码错误"));e()}},trigger:"blur"}]},signSuccess:{code:"",Visible:!1}}},watch:{islogin:function(){this.regCodeClass.drawAgain()},showSign:function(){this.showSign&&this.initRegcode()}},methods:{initRegcode:function(){var t=this;this.$nextTick(function(){t.regCodeClass=new o.a(t.$refs.regcode,{fontSize:20,lineNum:2,dotNum:10}),t.regCodeClass.draw(function(i){t.regcode=i})})},choose:function(t){this.$refs.signForm.resetFields(),this.islogin=t},experience:function(){this.showSign=!0},enter:function(t){var i=this;this.$refs.signForm.validate(function(s){if(!s)return!1;t?i.login():i.signUp()})},login:function(){var t=this,i={name:this.signForm.name,pass:this.signForm.pass};e.a.login(i).then(function(i){0===i.code?(t.$message.success("登录成功"),t.$store.dispatch("getUserInfo"),t.$router.push("/personalMain")):-1===i.code?t.$message.error("账号不存在或密码错误"):t.$message.error("登录失败")})},signUp:function(){var t=this,i={name:this.signForm.name,pass:this.signForm.pass};e.a.signUp(i).then(function(i){0===i.code?(t.$refs.signForm.resetFields(),t.signSuccess.Visible=!0,t.signSuccess.code=i.data):1===i.code?t.$message.error("账号已存在"):t.$message.error("注册失败")})},handelClose:function(t){this.islogin=!0,t()}},mounted:function(){}},a={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"vchat-login"},[s("div",{staticClass:"logo",class:{active:t.showSign}},[s("h3",{staticClass:"title"},[t._v("Hi, vChat !")]),t._v(" "),s("span",{staticClass:"begain",on:{click:t.experience}},[t._v("立即体验")])]),t._v(" "),t.showSign?s("div",{staticClass:"sign"},[s("div",{staticClass:"title"},[s("span",{class:{active:t.islogin},on:{click:function(i){t.choose(!0)}}},[t._v("登录")]),t._v(" "),s("span",{class:{active:!t.islogin},on:{click:function(i){t.choose(!1)}}},[t._v("注册")])]),t._v(" "),s("el-form",{ref:"signForm",staticClass:"signForm",attrs:{"label-width":"80px",rules:t.signRules,model:t.signForm}},[s("el-form-item",{attrs:{prop:"name"}},[s("el-input",{attrs:{placeholder:"账号"},model:{value:t.signForm.name,callback:function(i){t.$set(t.signForm,"name",i)},expression:"signForm.name"}},[s("i",{staticClass:"iconfont icon-zhanghao",attrs:{slot:"prepend"},slot:"prepend"})])],1),t._v(" "),s("el-form-item",{attrs:{prop:"pass"}},[s("el-input",{attrs:{placeholder:"密码",type:"password"},nativeOn:{keyup:function(i){if(!("button"in i)&&t._k(i.keyCode,"enter",13,i.key,"Enter"))return null;t.enter(t.islogin)}},model:{value:t.signForm.pass,callback:function(i){t.$set(t.signForm,"pass",i)},expression:"signForm.pass"}},[s("i",{staticClass:"iconfont icon-mima3",attrs:{slot:"prepend"},slot:"prepend"})])],1),t._v(" "),t.islogin?t._e():s("el-form-item",{attrs:{prop:"repass"}},[s("el-input",{attrs:{placeholder:"确认密码",type:"password"},nativeOn:{keyup:function(i){if(!("button"in i)&&t._k(i.keyCode,"enter",13,i.key,"Enter"))return null;t.enter(t.islogin)}},model:{value:t.signForm.repass,callback:function(i){t.$set(t.signForm,"repass",i)},expression:"signForm.repass"}},[s("i",{staticClass:"iconfont icon-mima2",attrs:{slot:"prepend"},slot:"prepend"})])],1),t._v(" "),s("el-form-item",{staticClass:"regcode-box",attrs:{prop:"regcode"}},[s("el-input",{attrs:{placeholder:"验证码"},nativeOn:{keyup:function(i){if(!("button"in i)&&t._k(i.keyCode,"enter",13,i.key,"Enter"))return null;t.enter(t.islogin)}},model:{value:t.signForm.regcode,callback:function(i){t.$set(t.signForm,"regcode",i)},expression:"signForm.regcode"}},[s("i",{staticClass:"iconfont icon-mima3",attrs:{slot:"prepend"},slot:"prepend"})]),t._v(" "),s("canvas",{ref:"regcode",attrs:{width:"90",height:"38"}})],1)],1),t._v(" "),s("button",{on:{click:function(i){t.enter(t.islogin)}}},[t._v(t._s(t.islogin?"登录":"注册"))]),t._v(" "),t.islogin?s("div",{staticClass:"login-foot"},[s("span"),t._v("\n            第三方登录\n            "),s("span")]):t._e()],1):t._e(),t._v(" "),s("el-dialog",{attrs:{title:"注册成功",visible:t.signSuccess.Visible,"before-close":t.handelClose,width:"40%"},on:{"update:visible":function(i){t.$set(t.signSuccess,"Visible",i)}}},[s("span",[t._v("您的Vchat号为："+t._s(t.signSuccess.code)+"，您可以凭此登录Vchat，祝您使用愉快！")]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(i){t.signSuccess.Visible=!1,t.islogin=!0}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var l=s("C7Lr")(r,a,!1,function(t){s("dfiO")},"data-v-30d48347",null);i.default=l.exports},dfiO:function(t,i){},"l+Ju":function(t,i,s){(function(t){class i{constructor(t,i={}){this.canvas=t,this.paint=this.canvas.getContext("2d"),this.lineWidth=i.lineWidth||.5,this.lineNum=i.lineNum||5,this.dotNum=i.dotNum||20,this.dotR=i.dotR||1,this.foregroundColor=i.foregroundColor||[10,80],this.backgroundColor=i.backgroundColor||[150,250],this.fontSize=i.fontSize||28,this.fontFamily=i.fontFamily||"Georgia",this.fontStyle=i.fontStyle||"fill",this.content=i.content||"acdefhijkmnpwxyABCDEFGHJKMNPQWXY12345789",this.len=i.len||4,this.callback=function(){},this.canvas.onclick=(()=>{this.drawAgain()})}getColor(t){let i,s,e=[];return t[0]>t[1]?(i=t[1],s=t[0]):(i=t[0],s=t[1]),e[0]=this.getRand(i,s),e[1]=this.getRand(i,s),e[2]=this.getRand(i,s),e}getRand(t,i){return Math.floor(Math.random()*(i-t)+t)}getText(){let t=this.content.length,i="";for(let s=0;s<this.len;s++)i+=this.content[this.getRand(0,t)];return i}line(){for(let t=0;t<this.lineNum;t++){let t=this.getRand(0,this.canvas.width),i=this.getRand(0,this.canvas.height),s=this.getRand(0,this.canvas.width),e=this.getRand(0,this.canvas.width);this.paint.beginPath(),this.paint.lineWidth=this.lineWidth,this.paint.strokeStyle=`rgba(${this.getColor(this.foregroundColor)[0]}, ${this.getColor(this.foregroundColor)[1]}, ${this.getColor(this.foregroundColor)[2]}, 0.8)`,this.paint.moveTo(t,i),this.paint.lineTo(s,e),this.paint.closePath(),this.paint.stroke()}}arc(){for(let t=0;t<this.dotNum;t++){let t=this.getRand(0,this.canvas.width),i=this.getRand(0,this.canvas.height);this.paint.beginPath(),this.paint.arc(t,i,this.dotR,0,2*Math.PI,!1),this.paint.closePath(),this.paint.fillStyle=`rgba(${this.getColor(this.foregroundColor)[0]}, ${this.getColor(this.foregroundColor)[1]}, ${this.getColor(this.foregroundColor)[2]}, 0.8)`,this.paint.fill()}}font(){let t=this.getText();this.callback(t),this.paint.font=`${this.fontSize}px ${this.fontFamily}`,this.paint.textBaseline="middle";let i=`${this.fontStyle}Text`,s=`${this.fontStyle}Style`;for(let e=0;e<this.len;e++){let n=this.paint.measureText(t[e]).width,o=this.getRand(this.canvas.width/this.len*e+n/2,this.canvas.width/this.len*(e+1)-n-5),r=this.getRand(-6,6);this.paint[s]=`rgba(${this.getColor(this.foregroundColor)[0]}, ${this.getColor(this.foregroundColor)[1]}, ${this.getColor(this.foregroundColor)[2]}, 0.8)`,this.paint.save(),this.paint.rotate(r*Math.PI/180),this.paint[i](t[e],o,this.canvas.height/2),this.paint.restore()}}draw(t){this.callback=t,this.paint.fillStyle=`rgba(${this.getColor(this.backgroundColor)[0]}, ${this.getColor(this.backgroundColor)[1]}, ${this.getColor(this.backgroundColor)[2]}, 0.8)`,this.paint.fillRect(0,0,this.canvas.width,this.canvas.height),this.line(),this.arc(),this.font()}clear(){this.paint.clearRect(0,0,this.canvas.width,this.canvas.height)}drawAgain(){this.clear(),this.draw(this.callback)}}void 0!==t&&!t.nodeType&&t.exports&&(t.exports=i)}).call(i,s("nS3N")(t))}});